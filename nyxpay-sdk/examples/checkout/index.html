<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nyx Pay - Payment Link Builder</title>
  <style>
    /* Complete CSS for link builder */
    * {
      box-sizing: border-box;
    }

    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      text-align: center; 
      padding: 40px; 
      background: #0a0a0a; 
      color: #f5f5f5;
      margin: 0;
      min-height: 100vh;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      background: #161616;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.6);
      border: 1px solid #333;
    }

    h1 {
      font-size: 32px;
      margin-bottom: 8px;
      color: #ffffff;
      font-weight: 700;
    }

    .subtitle {
      font-size: 18px;
      color: #aaaaaa;
      margin-bottom: 40px;
    }

    .form-group {
      margin-bottom: 24px;
      text-align: left;
    }

    label {
      display: block;
      color: #dddddd;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 600;
    }

    input, select {
      width: 100%;
      padding: 12px 16px;
      border-radius: 8px;
      border: 1px solid #333;
      font-size: 16px;
      background-color: #222222;
      color: #ffffff;
      transition: border-color 0.2s ease;
    }

    input:focus, select:focus {
      border-color: #ff6b00;
      outline: none;
      box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.1);
    }

    input::placeholder {
      color: #777777;
    }

    button {
      padding: 14px 24px;
      font-size: 16px;
      font-weight: 600;
      background: linear-gradient(135deg, #ff6b00 0%, #e05a00 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
      margin-top: 8px;
      box-shadow: 0 4px 12px rgba(255, 107, 0, 0.3);
    }

    button:hover {
      background: linear-gradient(135deg, #e05a00 0%, #cc5100 100%);
      box-shadow: 0 6px 16px rgba(255, 107, 0, 0.4);
      transform: translateY(-1px);
    }

    button:active {
      transform: translateY(0);
    }

    .secondary-button {
      background: #333333;
      box-shadow: none;
      margin-top: 12px;
    }

    .secondary-button:hover {
      background: #444444;
      transform: translateY(-1px);
    }

    .output-section {
      background: #1a1a1a;
      border-radius: 8px;
      padding: 24px;
      margin-top: 32px;
      border: 1px solid #333;
    }

    .output-section h2 {
      color: #ffffff;
      display: flex;
      align-items: center;
      margin: 0 0 16px 0;
      font-size: 20px;
    }

    .output-section h2:before {
      content: "üéØ";
      margin-right: 8px;
    }

    #checkoutLink {
      font-size: 14px;
      background-color: #222222;
      padding: 12px;
      border: 1px solid #333;
      margin-bottom: 12px;
      width: 100%;
      font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
      word-break: break-all;
    }

    .embed-section {
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #333;
    }

    .embed-section h3 {
      color: #ffffff;
      margin: 0 0 16px 0;
      font-size: 18px;
    }

    #buttonCode {
      font-size: 12px;
      background-color: #222222;
      padding: 16px;
      border: 1px solid #333;
      margin-bottom: 12px;
      width: 100%;
      height: 120px;
      font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
      resize: vertical;
    }

    .preview-section {
      background: #0a0a0a;
      border-radius: 6px;
      padding: 20px;
      margin: 16px 0;
      border: 1px solid #333;
    }

    .preview-section h4 {
      color: #aaaaaa;
      margin: 0 0 12px 0;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .network-selector {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .network-option {
      flex: 1;
      padding: 8px 12px;
      background: #333;
      border: 1px solid #555;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      font-size: 14px;
    }

    .network-option.active {
      background: #ff6b00;
      border-color: #ff6b00;
      color: white;
    }

    .network-option:hover:not(.active) {
      background: #444;
    }

    .warning {
      background: rgba(245, 158, 11, 0.1);
      border: 1px solid rgba(245, 158, 11, 0.3);
      color: #fbbf24;
      padding: 12px;
      border-radius: 6px;
      margin: 16px 0;
      font-size: 14px;
    }

    .hidden {
      display: none;
    }

    footer {
      margin-top: 40px;
      color: #777777;
      font-size: 14px;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      body {
        padding: 20px;
      }
      
      .container {
        padding: 24px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .network-selector {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Nyx Pay</h1>
    <p class="subtitle">Create payment links for Solana</p>

    <form id="builderForm">
      <div class="form-group">
        <label for="label">Payment Description</label>
        <input type="text" id="label" placeholder="Coffee, Donation, Service, etc." required>
      </div>

      <div class="form-group">
        <label for="amount">Amount</label>
        <input type="number" id="amount" step="0.000001" min="0.000001" placeholder="0.1" required>
      </div>

      <div class="form-group">
        <label for="tokenMint">Token</label>
        <select id="tokenMint">
          <option value="SOL">SOL (Solana)</option>
          <option value="USDC">USDC (USD Coin)</option>
          <option value="USDT">USDT (Tether)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="recipient">Recipient Address</label>
        <input type="text" id="recipient" placeholder="Your Solana wallet address" required>
      </div>

      <div class="form-group">
        <label>Network</label>
        <div class="network-selector">
          <div class="network-option active" data-network="devnet">
            Devnet (Free Testing)
          </div>
          <div class="network-option" data-network="mainnet-beta">
            Mainnet (Real Money)
          </div>
        </div>
      </div>

      <div class="warning" id="mainnetWarning" style="display: none;">
        ‚ö†Ô∏è Mainnet uses real SOL/tokens. Make sure to test on Devnet first!
      </div>

      <button type="submit">Generate Payment Link</button>
    </form>

    <div id="output" class="output-section hidden">
      <h2>Payment Link Generated</h2>
      
      <label for="checkoutLink">Share this link:</label>
      <input type="text" id="checkoutLink" readonly>
      <button type="button" id="copyButton" class="secondary-button">Copy Link</button>

      <div class="embed-section">
        <h3>Embed Button Code</h3>
        <textarea id="buttonCode" readonly placeholder="HTML code will appear here..."></textarea>
        <button type="button" id="copyEmbed" class="secondary-button">Copy Embed Code</button>
        
        <div class="preview-section">
          <h4>Live Preview:</h4>
          <div id="buttonPreview"></div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <p>Built on Solana ‚Ä¢ Powered by Nyx Pay</p>
  </footer>

  <script>
    class PaymentLinkBuilder {
      constructor() {
        this.selectedNetwork = 'devnet';
        this.baseUrl = 'https://nyxpaycheckout.vercel.app';
        this.setupEventListeners();
      }

      setupEventListeners() {
        // Form submission
        document.getElementById('builderForm').addEventListener('submit', (e) => this.handleFormSubmit(e));
        
        // Copy buttons
        document.getElementById('copyButton').addEventListener('click', () => this.copyToClipboard('checkoutLink'));
        document.getElementById('copyEmbed').addEventListener('click', () => this.copyToClipboard('buttonCode'));
        
        // Network selection
        document.querySelectorAll('.network-option').forEach(option => {
          option.addEventListener('click', (e) => this.selectNetwork(e.target.dataset.network));
        });

        // Amount input validation
        document.getElementById('amount').addEventListener('input', (e) => this.validateAmount(e));
      }

      selectNetwork(network) {
        this.selectedNetwork = network;
        
        // Update UI
        document.querySelectorAll('.network-option').forEach(option => {
          option.classList.toggle('active', option.dataset.network === network);
        });
        
        // Show/hide mainnet warning
        const warning = document.getElementById('mainnetWarning');
        warning.style.display = network === 'mainnet-beta' ? 'block' : 'none';
      }

      validateAmount(event) {
        const amount = parseFloat(event.target.value);
        const network = this.selectedNetwork;
        
        // Warn for large amounts
        if (network === 'mainnet-beta' && amount > 10) {
          event.target.style.borderColor = '#f59e0b';
        } else {
          event.target.style.borderColor = '#333';
        }
      }

      handleFormSubmit(event) {
        event.preventDefault();
        
        const formData = this.getFormData();
        
        if (!this.validateFormData(formData)) {
          return;
        }
        
        const paymentLink = this.generatePaymentLink(formData);
        const embedCode = this.generateEmbedCode(formData, paymentLink);
        
        this.displayResults(paymentLink, embedCode, formData);
      }

      getFormData() {
        return {
          label: document.getElementById('label').value.trim(),
          amount: parseFloat(document.getElementById('amount').value.trim()),
          tokenMint: document.getElementById('tokenMint').value,
          recipient: document.getElementById('recipient').value.trim(),
          network: this.selectedNetwork
        };
      }

      validateFormData(data) {
        const { label, amount, recipient, tokenMint } = data;
        
        if (!label) {
          this.showError('Please enter a payment description');
          return false;
        }
        
        if (!amount || isNaN(amount) || amount <= 0) {
          this.showError('Please enter a valid amount greater than 0');
          return false;
        }
        
        if (!recipient) {
          this.showError('Please enter a recipient address');
          return false;
        }
        
        if (!this.isValidSolanaAddress(recipient)) {
          this.showError('Please enter a valid Solana address');
          return false;
        }
        
        // Safety check for large amounts on mainnet
        if (data.network === 'mainnet-beta' && amount > 100) {
          const confirmed = confirm(
            `You're creating a link for ${amount} ${tokenMint} on mainnet. This is a large amount. Continue?`
          );
          if (!confirmed) return false;
        }
        
        return true;
      }

      generatePaymentLink(data) {
        const { recipient, amount, label, tokenMint, network } = data;
        const encodedLabel = encodeURIComponent(label);
        
        const params = new URLSearchParams({
          recipient,
          amount: amount.toString(),
          label: encodedLabel,
          tokenMint,
          network
        });
        
        return `${this.baseUrl}/?${params.toString()}`;
      }

      generateEmbedCode(data, paymentLink) {
        const { label, amount, tokenMint } = data;
        
        return `<a href="${paymentLink}" target="_blank" rel="noopener noreferrer"
   style="display: inline-block; padding: 12px 20px; background: linear-gradient(135deg, #ff6b00 0%, #e05a00 100%); 
          color: white; text-decoration: none; border-radius: 8px; font-weight: 600; 
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
          box-shadow: 0 4px 12px rgba(255, 107, 0, 0.3); transition: all 0.2s ease;"
   onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 16px rgba(255, 107, 0, 0.4)';"
   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(255, 107, 0, 0.3)';">
  ${label} ‚Äì ${amount} ${tokenMint}
</a>`.trim();
      }

      displayResults(paymentLink, embedCode, formData) {
        // Show output section
        const output = document.getElementById('output');
        output.classList.remove('hidden');
        
        // Set payment link
        document.getElementById('checkoutLink').value = paymentLink;
        
        // Set embed code
        document.getElementById('buttonCode').value = embedCode;
        
        // Show live preview
        const preview = document.getElementById('buttonPreview');
        preview.innerHTML = embedCode;
        
        // Scroll to results
        output.scrollIntoView({ behavior: 'smooth' });
        
        // Add click tracking to preview button
        const previewButton = preview.querySelector('a');
        if (previewButton) {
          previewButton.addEventListener('click', (e) => {
            e.preventDefault();
            console.log('Preview button clicked - would open:', paymentLink);
            window.open(paymentLink, '_blank');
          });
        }
      }

      async copyToClipboard(elementId) {
        const element = document.getElementById(elementId);
        const text = element.value;
        
        try {
          await navigator.clipboard.writeText(text);
          this.showSuccess('Copied to clipboard!');
        } catch (err) {
          // Fallback for older browsers
          element.select();
          document.execCommand('copy');
          this.showSuccess('Copied to clipboard!');
        }
      }

      isValidSolanaAddress(address) {
        try {
          // Basic Solana address validation (base58, 32-44 chars)
          return /^[A-HJ-NP-Za-km-z1-9]{32,44}$/.test(address);
        } catch {
          return false;
        }
      }

      showError(message) {
        // Create temporary error message
        const errorDiv = document.createElement('div');
        errorDiv.className = 'warning';
        errorDiv.textContent = `‚ùå ${message}`;
        errorDiv.style.marginTop = '16px';
        
        const form = document.getElementById('builderForm');
        form.appendChild(errorDiv);
        
        // Remove after 5 seconds
        setTimeout(() => {
          if (errorDiv.parentNode) {
            errorDiv.parentNode.removeChild(errorDiv);
          }
        }, 5000);
        
        // Scroll to error
        errorDiv.scrollIntoView({ behavior: 'smooth' });
      }

      showSuccess(message) {
        // Create temporary success message
        const successDiv = document.createElement('div');
        successDiv.style.cssText = `
          background: rgba(34, 197, 94, 0.1);
          border: 1px solid rgba(34, 197, 94, 0.3);
          color: #86efac;
          padding: 12px;
          border-radius: 6px;
          margin: 16px 0;
          font-size: 14px;
        `;
        successDiv.textContent = `‚úÖ ${message}`;
        
        const output = document.getElementById('output');
        output.appendChild(successDiv);
        
        // Remove after 3 seconds
        setTimeout(() => {
          if (successDiv.parentNode) {
            successDiv.parentNode.removeChild(successDiv);
          }
        }, 3000);
      }
    }

    // Initialize the app
    document.addEventListener('DOMContentLoaded', () => {
      new PaymentLinkBuilder();
    });
  </script>
</body>
</html>